import{al as n,o as l,k as s,l as i,u as t,w as m,c as u,y as d}from"./app.91faff10.js";import c from"./ModalAmbulatorio.53695a71.js";import{D as b,a as p,b as h,c as a,d as f}from"./data-grid.93ce6c9b.js";import{l as _}from"./check-box.3b03f7e3.js";import"./index.708a0cab.js";import{_ as g}from"./plugin-vue_export-helper.21dcd24c.js";import"./response.70bff4ea.js";import"./check_box.bd4929f9.js";import"./select-box.9cc7c130.js";import"./select_box.e8817efd.js";import"./number-box.75808b5b.js";import"./number_box.976ffa07.js";import"./text-area.ef96479a.js";import"./date_box.745fde92.js";import"./draggable.67b3fe5e.js";const w={emits:["notify"],data(){return{fetching:!1,modal_ambulatorio_id:null,ricerca:null,errors:null,ambulatori:[]}},computed:{disabledElement(){return this.fetching}},async created(){_("it-IT"),await axios.get("api/sphere/ambulatorio").then(o=>{this.ambulatori=o.data})},methods:{timezoneFixer(o){return n(o.value)},ambulatorioSalvato(o){this.ambulatori.push(o),this.$refs.griglia.instance.refresh(),this.$emit("notify","success","Ambulatorio salvato con successo"),this.modal_ambulatorio_id=null},async ambulatorioModificato(o){await axios.get("api/sphere/ambulatorio").then(e=>{this.ambulatori=e.data}),this.$emit("notify","success","Ambulatorio modificato con successo"),this.modal_ambulatorio_id=null},errorFor(o){return!!(this.errors!==null&&this.errors[o])},onRowPrepared(o){o.rowElement.className+=" hover:bg-gray-300"},openContextMenu(o){o.row&&this.$refs.griglia.instance.selectRows([o.row.key]),o.items=[{visible:o.rowIndex>-1,text:"Apri",icon:"showpanel",onItemClick:()=>{this.apriAmbulatorio(o.row.data.id)}},{visible:o.rowIndex>-1,text:"Elimina",icon:"trash",onItemClick:()=>{this.confermaEliminaAmbulatorio(o.rowIndex)}},{text:"Nuovo",icon:"plus",onItemClick:()=>{this.nuovoAmbulatorio()}}]},aggiornaRiga(o){},onRowDblClick(o){this.apriAmbulatorio(o.data.id)},confermaEliminaAmbulatorio(o){this.$refs.griglia.instance.option({"editing.texts.confirmDeleteMessage":"Sei sicuro di voler eliminare l'ambulatorio selezionato?"}),this.$refs.griglia.instance.deleteRow(o)},deleteAmbulatorio(o){o.cancel=axios.delete(`api/sphere/ambulatorio/${o.data.id}`).then(e=>(this.$emit("notify","success","Ambulatorio eliminato"),!1)).catch(e=>(this.$emit("notify","error","Errore","Eliminazione fallita"),!0))},nuovoAmbulatorio(){this.modal_ambulatorio_id="new"},apriAmbulatorio(o){this.modal_ambulatorio_id=o},async ricercaAmbulatorio(){this.fetching=!0,await axios.post("api/sphere/ricerca-ambulatorio",{ricerca:this.ricerca}).then(o=>{this.ambulatori=o.data}).catch(o=>{}),this.fetching=!1}}},v=Object.assign(w,{__name:"FormAmbulatori",setup(o){return(e,r)=>(l(),s("div",null,[i(t(b),{id:"griglia",ref:"griglia","data-source":e.ambulatori,"key-expr":"id","allow-column-reordering":!0,"allow-column-resizing":!0,"column-auto-width":!1,"column-min-width":50,"column-resizing-mode":"widget","row-alternation-enabled":!0,"show-row-lines":!0,"hover-state-enabled":!0,onContextMenuPreparing:e.openContextMenu,onRowPrepared:e.onRowPrepared,onRowDblClick:e.onRowDblClick,onRowRemoving:e.deleteAmbulatorio},{default:m(()=>[i(t(p),{mode:"single"}),i(t(h),{enabled:!0}),i(t(a),{"data-field":"id"}),i(t(a),{"data-field":"nome",caption:"Nome ambulatorio"}),i(t(a),{"data-field":"struttura_id",caption:"Struttura"}),i(t(a),{"data-field":"attivo"}),i(t(a),{"data-field":"created_at","customize-text":e.timezoneFixer},null,8,["customize-text"]),i(t(a),{"data-field":"updated_at","customize-text":e.timezoneFixer},null,8,["customize-text"]),i(t(f),{mode:"infinite"})]),_:1},8,["data-source","onContextMenuPreparing","onRowPrepared","onRowDblClick","onRowRemoving"]),e.modal_ambulatorio_id?(l(),u(c,{key:0,"ambulatorio-id":e.modal_ambulatorio_id,onClose:r[0]||(r[0]=x=>e.modal_ambulatorio_id=null),onStore:e.ambulatorioSalvato,onUpdate:e.ambulatorioModificato},null,8,["ambulatorio-id","onStore","onUpdate"])):d("",!0)]))}});var B=g(v,[["__scopeId","data-v-3b100e3c"]]);export{B as default};
