import{al as d,o as n,k as s,l as o,u as t,w as c,c as l,y as m}from"./app.91faff10.js";import u from"./ModalMedico.c89bde99.js";import{D as p,a as h,b as f,c as a,d as _}from"./data-grid.93ce6c9b.js";import{l as g}from"./check-box.3b03f7e3.js";import"./index.708a0cab.js";import{_ as w}from"./plugin-vue_export-helper.21dcd24c.js";import"./response.70bff4ea.js";import"./check_box.bd4929f9.js";import"./select-box.9cc7c130.js";import"./select_box.e8817efd.js";import"./text-area.ef96479a.js";import"./date_box.745fde92.js";import"./number_box.976ffa07.js";import"./draggable.67b3fe5e.js";const M={emits:["notify"],data(){return{fetching:!1,modal_medico_id:null,ricerca:null,errors:null,medici:[]}},computed:{disabledElement(){return this.fetching}},async created(){g("it-IT"),await axios.get("api/sphere/medico").then(e=>{this.medici=e.data})},methods:{timezoneFixer(e){return d(e.value)},medicoSalvato(e){this.medici.push(e),this.$refs.griglia.instance.refresh(),this.$emit("notify","success","Medico salvato con successo"),this.modal_medico_id=null},async medicoModificato(e){await axios.get("medico").then(i=>{this.medici=i.data}),this.$emit("notify","success","Medico modificato con successo"),this.modal_medico_id=null},errorFor(e){return!!(this.errors!==null&&this.errors[e])},onRowPrepared(e){e.rowElement.className+=" hover:bg-gray-300"},openContextMenu(e){e.row&&this.$refs.griglia.instance.selectRows([e.row.key]),e.items=[{visible:e.rowIndex>-1,text:"Apri",icon:"showpanel",onItemClick:()=>{this.apriMedico(e.row.data.id)}},{visible:e.rowIndex>-1,text:"Elimina",icon:"trash",onItemClick:()=>{this.confermaEliminaMedico(e.rowIndex)}},{text:"Nuovo",icon:"plus",onItemClick:()=>{this.nuovoMedico()}}]},aggiornaRiga(e){},onRowDblClick(e){this.apriMedico(e.data.id)},confermaEliminaMedico(e){this.$refs.griglia.instance.option({"editing.texts.confirmDeleteMessage":"Sei sicuro di voler eliminare il medico selezionato?"}),this.$refs.griglia.instance.deleteRow(e)},deleteMedico(e){e.cancel=axios.delete(`api/sphere/medico/${e.data.id}`).then(i=>(this.$emit("notify","success","Medico eliminato"),!1)).catch(i=>(this.$emit("notify","error","Errore","Eliminazione fallita"),!0))},nuovoMedico(){this.modal_medico_id="new"},apriMedico(e){this.modal_medico_id=e},async ricercaMedico(){this.fetching=!0,await axios.post("api/sphere/ricerca-medico",{ricerca:this.ricerca}).then(e=>{this.medici=e.data}).catch(e=>{}),this.fetching=!1}}},v=Object.assign(M,{__name:"FormMedici",setup(e){return(i,r)=>(n(),s("div",null,[o(t(p),{id:"griglia",ref:"griglia","data-source":i.medici,"key-expr":"id","allow-column-reordering":!0,"allow-column-resizing":!0,"column-auto-width":!1,"column-min-width":50,"column-resizing-mode":"widget","row-alternation-enabled":!0,"show-row-lines":!0,"hover-state-enabled":!0,onContextMenuPreparing:i.openContextMenu,onRowPrepared:i.onRowPrepared,onRowDblClick:i.onRowDblClick,onRowRemoving:i.deleteMedico},{default:c(()=>[o(t(h),{mode:"single"}),o(t(f),{enabled:!0}),o(t(a),{"data-field":"id"}),o(t(a),{"data-field":"ragione_sociale",caption:"Ragione Sociale"}),o(t(a),{"data-field":"codice_fiscale",caption:"Codice fiscale"}),o(t(a),{"data-field":"sphere_user_id",caption:"Utente Sphere associato"}),o(t(a),{"data-field":"struttura",caption:"Struttura"}),o(t(a),{"data-field":"created_at","customize-text":i.timezoneFixer},null,8,["customize-text"]),o(t(a),{"data-field":"updated_at","customize-text":i.timezoneFixer},null,8,["customize-text"]),o(t(_),{mode:"infinite"})]),_:1},8,["data-source","onContextMenuPreparing","onRowPrepared","onRowDblClick","onRowRemoving"]),i.modal_medico_id?(n(),l(u,{key:0,"medico-id":i.modal_medico_id,onClose:r[0]||(r[0]=x=>i.modal_medico_id=null),onStore:i.medicoSalvato,onUpdate:i.medicoModificato},null,8,["medico-id","onStore","onUpdate"])):m("",!0)]))}});var B=w(v,[["__scopeId","data-v-96a27c6c"]]);export{B as default};
