import{aj as l,ak as d,b as s,al as c,o as r,k as p,l as i,u as a,w as m,c as u,y as z}from"./app.91faff10.js";import f from"./ModalPaziente.6c0d45eb.js";import{D as h,a as _,b as g,c as o,d as w}from"./data-grid.93ce6c9b.js";import{l as v}from"./check-box.3b03f7e3.js";import"./index.708a0cab.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import"./response.70bff4ea.js";import"./check_box.bd4929f9.js";import"./select-box.9cc7c130.js";import"./select_box.e8817efd.js";import"./date-box.cf07a735.js";import"./date_box.745fde92.js";import"./number_box.976ffa07.js";import"./radio-group.6a7b6bf0.js";import"./text-area.ef96479a.js";import"./data_source.6be12e61.js";import"./draggable.67b3fe5e.js";const x=e=>(l("data-v-cbcb4222"),e=e(),d(),e),b={class:"flex flex-col content-between h-full"},C={class:"grow"},k=x(()=>s("div",{class:"shrink h-20 bg-gray-300"}," asd ",-1)),y={emits:["notify"],remember:{data:["pazienti"]},data(){return{fetching:!1,modal_paziente_id:null,ricerca:null,errors:null,pazienti:[]}},computed:{disabledElement(){return this.fetching}},async created(){v("it-IT"),await axios.get("api/sphere/paziente").then(e=>{this.pazienti=e.data})},methods:{timezoneFixer(e){return c(e.value)},pazienteSalvato(e){this.pazienti.push(e),this.$refs.griglia.instance.refresh(),this.$emit("notify","success","Paziente salvato con successo"),this.modal_paziente_id=null},async pazienteModificato(e){await axios.get("api/sphere/paziente").then(t=>{this.pazienti=t.data}),this.$emit("notify","success","Paziente modificato con successo"),this.modal_paziente_id=null},errorFor(e){return!!(this.errors!==null&&this.errors[e])},onRowPrepared(e){e.rowElement.className+=" hover:bg-gray-300"},openContextMenu(e){e.row&&this.$refs.griglia.instance.selectRows([e.row.key]),e.items=[{visible:e.rowIndex>-1,text:"Apri",icon:"showpanel",onItemClick:()=>{this.apriPaziente(e.row.data.id)}},{visible:e.rowIndex>-1,text:"Elimina",icon:"trash",onItemClick:()=>{this.confermaEliminaPaziente(e.rowIndex)}},{text:"Nuovo",icon:"plus",onItemClick:()=>{this.nuovoPaziente()}}]},aggiornaRiga(e){},onRowDblClick(e){this.apriPaziente(e.data.id)},confermaEliminaPaziente(e){this.$refs.griglia.instance.option({"editing.texts.confirmDeleteMessage":"Sei sicuro di voler eliminare il paziente selezionato?"}),this.$refs.griglia.instance.deleteRow(e)},deletePaziente(e){e.cancel=axios.delete(`api/sphere/paziente/${e.data.id}`).then(t=>(this.$emit("notify","success","Paziente eliminato"),!1)).catch(t=>(this.$emit("notify","error","Errore","Eliminazione fallita"),!0))},nuovoPaziente(){this.modal_paziente_id="new"},apriPaziente(e){this.modal_paziente_id=e},async ricercaPaziente(){this.fetching=!0,await axios.post("api/sphere/ricerca-paziente",{ricerca:this.ricerca}).then(e=>{this.pazienti=e.data}).catch(e=>{}),this.fetching=!1}}},R=Object.assign(y,{__name:"FormPazienti",setup(e){return(t,n)=>(r(),p("div",b,[s("div",C,[i(a(h),{id:"griglia",ref:"griglia","data-source":t.pazienti,"key-expr":"id","allow-column-reordering":!0,"allow-column-resizing":!0,"column-auto-width":!1,"column-min-width":50,"column-resizing-mode":"widget","row-alternation-enabled":!0,"show-row-lines":!0,"hover-state-enabled":!0,onContextMenuPreparing:t.openContextMenu,onRowPrepared:t.onRowPrepared,onRowDblClick:t.onRowDblClick,onRowRemoving:t.deletePaziente},{default:m(()=>[i(a(_),{mode:"single"}),i(a(g),{enabled:!0}),i(a(o),{"data-field":"id"}),i(a(o),{"data-field":"codice"}),i(a(o),{"data-field":"ragione_sociale"}),i(a(o),{"data-field":"codice_fiscale"}),i(a(o),{"data-field":"sesso"}),i(a(o),{"data-field":"data_nascita",caption:"Data di nascita"}),i(a(o),{"data-field":"localita_residenza.nome",caption:"Localit\xE0 di residenza"}),i(a(o),{"data-field":"localita_residenza.sigla_provincia",caption:"Provincia di residenza"}),i(a(o),{"data-field":"indirizzo",caption:"Indirizzo"}),i(a(o),{"data-field":"civico",caption:"Numero civico"}),i(a(o),{"data-field":"localita_nascita.nome",caption:"Localit\xE0 di nascita"}),i(a(o),{"data-field":"localita_nascita.sigla_provincia",caption:"Provincia di nascita"}),i(a(o),{"data-field":"created_at","customize-text":t.timezoneFixer},null,8,["customize-text"]),i(a(o),{"data-field":"updated_at","customize-text":t.timezoneFixer},null,8,["customize-text"]),i(a(w),{mode:"infinite"})]),_:1},8,["data-source","onContextMenuPreparing","onRowPrepared","onRowDblClick","onRowRemoving"])]),k,t.modal_paziente_id?(r(),u(f,{key:0,"paziente-id":t.modal_paziente_id,onClose:n[0]||(n[0]=D=>t.modal_paziente_id=null),onStore:t.pazienteSalvato,onUpdate:t.pazienteModificato},null,8,["paziente-id","onStore","onUpdate"])):z("",!0)]))}});var H=P(R,[["__scopeId","data-v-cbcb4222"]]);export{H as default};
